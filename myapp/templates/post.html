{% extends "base.html" %}
{% block content %}
<div class="jumbotron">
  <h1>{{ post.title }}</h1>
  <h2>Written by: {{post.author.username}}</h2>
  <h3>Published: {{ post.date.strftime('%B %d, %Y') }}</h3>
  <p>{{post.description}}</p>
  <p>Voted pro: {{pro_votes}} Voted against: {{votes_against}}</p>
   {% if post.author == current_user %}
     <div>
       <form action="{{ url_for('posts.delete_post', post_id=post.id) }}" method="POST">
        <input class="btn btn-danger" type="submit" value="Delete">
      </form>
     </div>
     {% else %}
     {% if vote.vote_pro %}
      <p>You voted pro</p>
      {% elif vote.vote_against %}
      <p>You voted against</p>
      {% else %}
      <p>You haven't voted yet</p>
      {% endif %}
     <div>
      <form action="{{ url_for('votes.add_vote_pro', post_id=post.id) }}" method="POST">
        <input class="btn btn-secondary" type="submit" value="Pro">
      </form>
     <div>
      <form action="{{ url_for('votes.add_vote_against', post_id=post.id) }}" method="POST">
        <input class="btn btn-danger" type="submit" value="Against">
      </form>
     </div>
   {% endif %}
   <div class="container">
    <form class="form-group" method="POST" action="{{ url_for('comments.add_comment', post_id=post.id) }}">
        {{form.hidden_tag()}}
        <div class="form-group">
          {{form.text.label(class="form-control-label")}}
          {{form.text(class="form-control form-control-lg")}}
      </div>
      <div class="form-group">
          {{form.submit(class="btn btn-outline-info")}}
      </div>
    </form>
  </div>
     <div class="container">
      {% for comment in comments.items %}
      <div class="card">
          <div class="car-boy">
              <p>{{comment.text}}</p>
              <p>Author: {{comment.author.username}}</p>
              <p>Commented on {{comment.date.strftime('%B %d, %Y')}} at {{comment.date.strftime('%I:%M %p')}}</p>
          </div>
          {% if comment.author == current_user %}
            <div>
              <a class="btn btn-secondary" href="{{ url_for('comments.update', comment_id=comment.id) }}">Update</a>
              <br>
              <form action="{{ url_for('comments.delete_comment', comment_id=comment.id) }}" method="POST">
                <input class="btn btn-danger" type="submit" value="Delete">
              </form>
            </div>
          {% endif %}
      </div>
  {% endfor %}
     </div>
   
</div>
<nav aria-label="Page Navigation example">
  <ul class="pagination justify-content-center">

      {% for page_num in comments.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
          {% if comments.page == page_num %}
          <li class="page-item disabled">
              <a class="page-link" href="{{url_for('posts.post', post_id=post.id, page=page_num)}}">{{ page_num }}</a>
          </li>
          {% else %}
          <li class="page-item">
              <a class="page-link" href="{{url_for('posts.post', post_id=post.id, page=page_num)}}">{{ page_num }}</a>
          </li>
          {% endif %}
      {% endfor %}
  </ul>
</nav>
{% endblock content %}